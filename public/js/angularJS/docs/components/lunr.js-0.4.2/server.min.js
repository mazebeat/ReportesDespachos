var http=require("http"),url=require("url"),join=require("path").join,exists=require("path").exists,extname=require("path").extname,join=require("path").join,fs=require("fs"),port=process.argv[2]||3000;var mime={html:"text/html",css:"text/css",js:"application/javascript"};http.createServer(function(d,b){console.log("  \033[90m%s \033[36m%s\033[m",d.method,d.url);var f=url.parse(d.url).pathname,e=join(process.cwd(),f);function c(){b.statusCode=404;b.end("404 Not Found\n")}function a(g){b.statusCode=500;b.end(g.message+"\n")}exists(e,function(g){if(!g){return c()}fs.stat(e,function(i,h){if(i){return a()}if(h.isDirectory()){e=join(e,"index.html")}b.setHeader("Cache-Control","no-cache");b.setHeader("Content-Type",mime[e.split(".").slice(-1)]||"application/octet-stream");fs.createReadStream(e).pipe(b)})})}).listen(port);console.log("\n  Server listening on %d\n",port);