(function(d,c){if(typeof exports=="object"){module.exports=c()}else{if(typeof define=="function"&&define.amd){define(c)}else{d.Spinner=c()}}})(this,function(){var B=["webkit","Moz","ms","O"],q={},r;function z(d,a){var c=document.createElement(d||"div"),b;for(b in a){c[b]=a[b]}return c}function y(b){for(var c=1,a=arguments.length;c<a;c++){b.appendChild(arguments[c])}return b}var x=function(){var a=z("style",{type:"text/css"});y(document.getElementsByTagName("head")[0],a);return a.sheet||a.styleSheet}();function D(g,b,f,c){var a=["opacity",b,~~(g*100),f,c].join("-"),i=0.01+f/c*100,d=Math.max(1-(1-g)/b*(100-i),g),e=r.substring(0,r.indexOf("Animation")).toLowerCase(),h=e&&"-"+e+"-"||"";if(!q[a]){x.insertRule("@"+h+"keyframes "+a+"{0%{opacity:"+d+"}"+i+"%{opacity:"+g+"}"+(i+0.01)+"%{opacity:1}"+(i+b)%100+"%{opacity:"+g+"}100%{opacity:"+d+"}}",x.cssRules.length);q[a]=1}return a}function t(b,a){var c=b.style,e,d;a=a.charAt(0).toUpperCase()+a.slice(1);for(d=0;d<B.length;d++){e=B[d]+a;if(c[e]!==undefined){return e}}if(c[a]!==undefined){return a}}function A(c,a){for(var b in a){c.style[t(c,b)||b]=a[b]}return c}function v(b){for(var d=1;d<arguments.length;d++){var c=arguments[d];for(var a in c){if(b[a]===undefined){b[a]=c[a]}}}return b}function w(b){var a={x:b.offsetLeft,y:b.offsetTop};while(b=b.offsetParent){a.x+=b.offsetLeft,a.y+=b.offsetTop}return a}function s(a,b){return typeof a=="string"?a:a[b%a.length]}var C={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:1/4,fps:20,zIndex:2000000000,className:"spinner",top:"50%",left:"50%",position:"absolute"};function E(a){this.opts=v(a||{},E.defaults,C)}E.defaults={};v(E.prototype,{spin:function(f){this.stop();var b=this,a=b.opts,m=b.el=A(z(0,{className:a.className}),{position:a.position,width:0,zIndex:a.zIndex}),d=a.radius+a.length+a.width;A(m,{left:a.left,top:a.top});if(f){f.insertBefore(m,f.firstChild||null)}m.setAttribute("role","progressbar");b.lines(m,b.opts);if(!r){var i=0,c=(a.lines-1)*(1-a.direction)/2,j,l=a.fps,g=l/a.speed,h=(1-a.opacity)/(g*a.trail/100),e=g/a.lines;(function k(){i++;for(var n=0;n<a.lines;n++){j=Math.max(1-(i+(a.lines-n)*e)%g*h,a.opacity);b.opacity(m,n*a.direction+c,j,a)}b.timeout=b.el&&setTimeout(k,~~(1000/l))})()}return b},stop:function(){var a=this.el;if(a){clearTimeout(this.timeout);if(a.parentNode){a.parentNode.removeChild(a)}this.el=undefined}return this},lines:function(d,b){var e=0,a=(b.lines-1)*(1-b.direction)/2,f;function c(h,g){return A(z(),{position:"absolute",width:b.length+b.width+"px",height:b.width+"px",background:h,boxShadow:g,transformOrigin:"left",transform:"rotate("+~~(360/b.lines*e+b.rotate)+"deg) translate("+b.radius+"px,0)",borderRadius:(b.corners*b.width>>1)+"px"})}for(;e<b.lines;e++){f=A(z(),{position:"absolute",top:1+~(b.width/2)+"px",transform:b.hwaccel?"translate3d(0,0,0)":"",opacity:b.opacity,animation:r&&D(b.opacity,b.trail,a+e*b.direction,b.lines)+" "+1/b.speed+"s linear infinite"});if(b.shadow){y(f,A(c("#000","0 0 4px #000"),{top:2+"px"}))}y(d,y(f,c(s(b.color,e),"0 0 1px rgba(0,0,0,.1)")))}return d},opacity:function(b,c,a){if(c<b.childNodes.length){b.childNodes[c].style.opacity=a}}});function u(){function a(b,c){return z("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}x.addRule(".spin-vml","behavior:url(#default#VML)");E.prototype.lines=function(h,i){var j=i.length+i.width,b=2*j;function c(){return A(a("group",{coordsize:b+" "+b,coordorigin:-j+" "+-j}),{width:b,height:b})}var g=-(i.width+i.length)*2+"px",d=A(c(),{position:"absolute",top:g,left:g}),e;function f(k,l,m){y(d,y(A(c(),{rotation:360/i.lines*k+"deg",left:~~l}),y(A(a("roundrect",{arcsize:i.corners}),{width:j,height:i.width,left:i.radius,top:-i.width>>1,filter:m}),a("fill",{color:s(i.color,k),opacity:i.opacity}),a("stroke",{opacity:0}))))}if(i.shadow){for(e=1;e<=i.lines;e++){f(e,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(e=1;e<=i.lines;e++){f(e)}return y(h,d)};E.prototype.opacity=function(e,f,c,d){var b=e.firstChild;d=d.shadow&&d.lines||0;if(b&&f+d<b.childNodes.length){b=b.childNodes[f+d];b=b&&b.firstChild;b=b&&b.firstChild;if(b){b.opacity=c}}}}var F=A(z("group"),{behavior:"url(#default#VML)"});if(!t(F,"transform")&&F.adj){u()}else{r=t(F,"animation")}return E});